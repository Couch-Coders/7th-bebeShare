<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns="http://www.w3.org/1999/html"
      layout:decorate="~{layouts/layout}">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <th:block layout:fragment="css">
        <style th:inline="css">
            .center-img {
                height: 500px;
                width: 400%;
            }

            .card-text {
                height: 300px;
            }
        </style>
    </th:block>

    <title>배배쉐어</title>

    <th:block layout:fragment="script">
        <script>


        </script>
    </th:block>
</head>

<!-- navbar -->
<th:block layout:fragment="content">

    <!-- main -->
    <div class="container p-5">
        <!-- post upload form title & contents & multiple images & image preview -->
        <div class="row justify-content-center d-flex">
            <div class="col-md-10">
                <!-- form title input -->
                <div class="form-group">
                    <div class="mb-4">
                        <label for="form-title">제목</label>
                        <input type="text" class="form-control" id="form-title" name="title" placeholder="제목을 입력해주세요." required>
                    </div>
                    <!-- select tags use toggle button -->
                    <div class="form-group mb-4">
                        <!-- select tags checkbox-->
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="form-tag" value="여행">여행
                            <input class="form-check-input" type="radio" name="form-tag" value="운동">운동
                        </div>
                        <!-- tags -->
                    </div>
                    <!-- contents -->
                    <div class="form-group mb-4">
                        <label for="form-contents">내용</label>
                        <textarea class="form-control" id="form-contents" rows="15" required></textarea>
                    </div>
                    <!-- images -->
                    <div class="form-group mb-4">
                        <label for="form-images">이미지</label>
                        <form method="post" th:action="@{/upload}" enctype="multipart/form-data" class="image-group">
                            <input type="file" name="image" class="form-control" id="form-images" placeholder="이미지를 업로드해주세요.">
                            <input type="submit" value="업로드">
                        </form>
                        <!-- images -->
                    </div>
                    <!-- 등록 취소 버튼 in center -->
                    <div class="form-group d-flex justify-content-between">
                        <button type="button" class="btn btn-secondary" id="post-cancel" onclick="location.href='/'">취소</button>
                        <button type="submit" class="btn btn-primary" id="post-submit" onclick="createProduct()">등록</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <script th:inline="javascript">
         function createProduct(){
            user = [[ ${user} ]]; //sessionuser객체인 user를 User객체로 어떻게 바꾸지
            alert("등록메서드"+[[ ${userName} ]]+" // "+user);
            // var user =
            var title = document.querySelector('#form-title').value;
            var contents = document.querySelector('#form-contents').value;
            var category = $("input:radio[name='form-tag']:checked").val();
            data = {
                'user' : user,
                'productName' : title,
                'productContent' :contents,
                // 'productImage1' : ,
                // 'productImage2' : ,
                // 'productImage3' : ,
                'productCategory' : category,
                'productStatus' : "S",
                'deleteYn' : "N"
            };
            $.ajax({
                url : '/api/v1/products',
                type : "POST",
                contentType: 'application/json',
                data : JSON.stringify(data),
            }).done(function (response) {
                // response.redirect('/');
            })
        }
    </script>
</th:block>
</html>

